{"version":3,"file":"component---src-pages-index-js-04c6ebaa053fa25e49b7.js","mappings":"kKAAA,EAAe,IAA0B,mDCAzC,EAAe,IAA0B,sDCQnCA,EAFe,IACD,IAqJpB,EAlJkB,WAChB,IAAMC,GAAQC,EAAAA,EAAAA,UACRC,GAASD,EAAAA,EAAAA,UAEf,GAAsCE,EAAAA,EAAAA,YAA/BC,EAAP,KAAoBC,EAApB,KAEMC,EAAY,WAChBN,EAAMO,QAAQC,QAEd,IAAMC,EAAUP,EAAOK,QAAQG,WAAW,MAEpCC,EAAaC,OAAOC,iBAAiBb,EAAMO,SAC3CO,EAAiBC,WAAWJ,EAAWK,OACvCC,EAAkBF,WAAWJ,EAAWO,QAC9CC,QAAQC,IAAR,uBAAmCN,EAAnC,WAA4DG,GAM5D,MAAoCjB,EAAMO,QAAlCc,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,YACpBH,QAAQC,IAAR,mBAA+BC,EAA/B,WAAoDC,GAEpD,IAAMC,EAAeD,EAAcD,EAC7BG,EAAmBP,EAAkBH,EAE3C,EAA2CU,EAAkBzB,EACzD,CAACe,EAAgBA,EAAiBf,GAClC,CAACkB,EAAkBlB,EAAakB,GAF7BQ,EAAP,KAAuBC,EAAvB,KAGAP,QAAQC,IAAR,uBAAmCK,EAAnC,WAA4DC,GAE5D,IAAMC,EAAcJ,EAAcC,EAC7BH,EAAaP,EACbQ,EAAcL,EACnBE,QAAQC,IAAR,kBAA8BO,GAE9B,IAAMC,EAAIH,EAAiBE,EACrBE,EAAIH,EAAkBC,EACtBG,GAAKT,EAAaO,GAAK,EACvBG,GAAKT,EAAcO,GAAK,EAE9BV,QAAQC,IAAR,mBAA+BU,EAA/B,MAAsCC,EAAtC,MAA6CH,EAA7C,MAAoDC,GACpDpB,EAAQuB,UAAUhC,EAAMO,QAASuB,EAAGC,EAAGH,EAAGC,EAAG,EAAG,EA7ChC,IADC,KAgDjB3B,EAAOK,QAAQ0B,QAAO,SAAAC,GACpBf,QAAQC,IAAR,WAAwBc,GACxB,IAAMC,EAAMC,IAAIC,gBAAgBH,GAChC7B,EAAe8B,OAmBnB,OAfAG,EAAAA,EAAAA,YAAU,WACRC,UAAUC,aAAaC,aAAa,CAClCzC,OAAO,EACP0C,OAAO,IAENC,MAAK,SAAAC,GACJ5C,EAAMO,QAAQsC,UAAYD,EAE1BE,WAAWxC,EAAW,QAEvByC,OAAM,SAAAC,GACL7B,QAAQ8B,MAAMD,QAEjB,IAGD,2BACE,yBACEE,IAAK,SAAAA,GAAG,OAAIlD,EAAMO,QAAU2C,GAC5BC,MAAO,CACLC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNtC,MAAO,OACPE,OAAQ,OACRqC,QAAS,QACTC,UAAW,SAEbC,UAAQ,EACRC,aAAW,EACXC,OAAK,EACLC,OAAQC,IAOV,0BACEX,IAAK,SAAAA,GAAG,OAAIhD,EAAOK,QAAU2C,GAC7BC,MAAO,CACLC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNtC,MAAO,OACPE,OAAQ,OACRqC,QAAS,QACTC,UAAW,WAEbxC,MAvGY,IAwGZE,OAzGa,MA2Gf,uBACE4C,IAAKC,EACLZ,MAAO,CACLC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNtC,MAAO,OACPE,OAAQ,OACRqC,QAAS,QACTC,UAAW,WAEbQ,IAAI,gBAEN,uBAAKb,MAAO,CACVC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNW,MAAO,EACPC,OAAQ,EACRX,QAAS,OACTY,cAAe,SACfC,eAAgB,kBAEhB,uBAAKjB,MAAO,CACVjC,OAAQ,OAEV,uBAAKiC,MAAO,CACVjC,OAAQ,IACRqC,QAAS,OACTa,eAAgB,SAChBC,WAAY,WAEXjE,GACC,qBAAGkE,KAAMlE,EAAamE,UAAQ,GAA9B","sources":["webpack://gum-test/./src/images/test.png","webpack://gum-test/./src/images/img10-f.png","webpack://gum-test/./src/pages/index.js"],"sourcesContent":["export default __webpack_public_path__ + \"static/test-f8a27158c0bc147a46bd66e7f35c1a3a.png\";","export default __webpack_public_path__ + \"static/img10-f-651f5d532c0dcd9c7764a17e17895bcd.png\";","import React, { useEffect, useRef, useState } from \"react\"\n\nimport './styles.scss'\nimport testImage from '../images/test.png'\nimport frameImage from '../images/img10-f.png'\n\nconst FRAME_HEIGHT = 640\nconst FRAME_WIDTH = 480\nconst frameAspect = FRAME_HEIGHT / FRAME_WIDTH\n\nconst IndexPage = () => {\n  const video = useRef()\n  const canvas = useRef()\n\n  const [downloadURL, setDownloadURL] = useState()\n\n  const takePhoto = () => {\n    video.current.pause()\n\n    const context = canvas.current.getContext('2d')\n\n    const videoStyle = window.getComputedStyle(video.current)\n    const videoViewWidth = parseFloat(videoStyle.width)\n    const videoViewHeight = parseFloat(videoStyle.height)\n    console.log(`*** videoView width=${videoViewWidth} height=${videoViewHeight}`)\n    // const canvasStyle = window.getComputedStyle(canvas.current)\n    // console.log(`*** canvas width=${canvasStyle.width} height=${canvasStyle.height}`)\n    // const frameStyle = window.getComputedStyle(frame.current)\n    // console.log(`*** frame width=${frameStyle.width} height=${frameStyle.height}`)\n\n    const { videoWidth, videoHeight } = video.current\n    console.log(`*** video width=${videoWidth} height=${videoHeight}`)\n\n    const videoAspect = (videoHeight / videoWidth)\n    const videoViewAspect = (videoViewHeight / videoViewWidth)\n\n    const [frameViewWidth, frameViewHeight] = (videoViewAspect > frameAspect)\n      ? [videoViewWidth, videoViewWidth * frameAspect]\n      : [videoViewHeight / frameAspect, videoViewHeight]\n    console.log(`*** frameView width=${frameViewWidth} height=${frameViewHeight}`)\n\n    const videoRatio = (videoAspect > videoViewAspect)\n      ? (videoWidth / videoViewWidth)\n      : (videoHeight / videoViewHeight)\n    console.log(`*** videoRatio=${videoRatio}`)\n\n    const w = frameViewWidth * videoRatio\n    const h = frameViewHeight * videoRatio\n    const x = (videoWidth - w) / 2\n    const y = (videoHeight - h) / 2\n\n    console.log(`*** drawImage x=${x} y=${y} w=${w} h=${h}`)\n    context.drawImage(video.current, x, y, w, h, 0, 0, FRAME_WIDTH, FRAME_HEIGHT)\n\n    canvas.current.toBlob(blob => {\n      console.log(`*** blob`, blob)\n      const url = URL.createObjectURL(blob)\n      setDownloadURL(url)\n    })\n  }\n\n  useEffect(() => {\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: false\n    })\n      .then(stream => {\n        video.current.srcObject = stream\n\n        setTimeout(takePhoto, 3000)\n      })\n      .catch(err => {\n        console.error(err)\n      })\n  }, [])\n\n  return (\n    <div>\n      <video\n        ref={ref => video.current = ref}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          display: 'block',\n          objectFit: 'cover'\n        }}\n        autoPlay\n        playsInline\n        muted\n        poster={testImage}\n        // width={IMAGE_WIDTH}\n        // height={IMAGE_HEIGHT}\n        // onLoadedMetadata={() => {\n        //   console.log(`*** height=${video.current.videoHeight} width=${video.current.videoWidth}`)\n        // }}\n      />\n      <canvas\n        ref={ref => canvas.current = ref}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          display: 'block',\n          objectFit: 'contain'\n        }}\n        width={FRAME_WIDTH}\n        height={FRAME_HEIGHT}\n      />\n      <img\n        src={frameImage}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          display: 'block',\n          objectFit: 'contain'\n        }}\n        alt=\"Frame image\"\n      />\n      <div style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-between'\n      }}>\n        <div style={{\n          height: 100\n        }}></div>\n        <div style={{\n          height: 100,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center'\n        }}>\n          {downloadURL &&\n            <a href={downloadURL} download >\n              DOWNLOAD\n            </a>\n          }\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default IndexPage\n"],"names":["frameAspect","video","useRef","canvas","useState","downloadURL","setDownloadURL","takePhoto","current","pause","context","getContext","videoStyle","window","getComputedStyle","videoViewWidth","parseFloat","width","videoViewHeight","height","console","log","videoWidth","videoHeight","videoAspect","videoViewAspect","frameViewWidth","frameViewHeight","videoRatio","w","h","x","y","drawImage","toBlob","blob","url","URL","createObjectURL","useEffect","navigator","mediaDevices","getUserMedia","audio","then","stream","srcObject","setTimeout","catch","err","error","ref","style","position","top","left","display","objectFit","autoPlay","playsInline","muted","poster","testImage","src","frameImage","alt","right","bottom","flexDirection","justifyContent","alignItems","href","download"],"sourceRoot":""}